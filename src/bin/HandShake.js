const _0xe91e98=_0x1b84;function _0x1403(_0x52336b,_0x4e5f38){const _0x1b84b6=_0x4e5f();_0x1403=function(_0x1b3a0c,_0x27ad8a){_0x1b3a0c=_0x1b3a0c-0x0;let _0x76fa91=_0x1b84b6[_0x1b3a0c];if(_0x1403['UUaMDp']===undefined){var _0x2d01e5=function(_0x547a13){const _0x4654c7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x58d0da='';let _0x506ad5='';for(let _0x588618=0x0,_0x23592e,_0x2fefa4,_0x66d9b7=0x0;_0x2fefa4=_0x547a13['charAt'](_0x66d9b7++);~_0x2fefa4&&(_0x23592e=_0x588618%0x4?_0x23592e*0x40+_0x2fefa4:_0x2fefa4,_0x588618++%0x4)?_0x58d0da+=String['fromCharCode'](0xff&_0x23592e>>(-0x2*_0x588618&0x6)):0x0){_0x2fefa4=_0x4654c7['indexOf'](_0x2fefa4);}for(let _0x51ec31=0x0,_0x58a0eb=_0x58d0da['length'];_0x51ec31<_0x58a0eb;_0x51ec31++){_0x506ad5+='%'+('00'+_0x58d0da['charCodeAt'](_0x51ec31)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x506ad5);};const _0x15227c=function(_0x1777f7,_0x1a87b9){let _0x51af92=[],_0x4b478f=0x0,_0x34a40b,_0x43d090='';_0x1777f7=_0x2d01e5(_0x1777f7);let _0x43e70e;for(_0x43e70e=0x0;_0x43e70e<0x100;_0x43e70e++){_0x51af92[_0x43e70e]=_0x43e70e;}for(_0x43e70e=0x0;_0x43e70e<0x100;_0x43e70e++){_0x4b478f=(_0x4b478f+_0x51af92[_0x43e70e]+_0x1a87b9['charCodeAt'](_0x43e70e%_0x1a87b9['length']))%0x100;_0x34a40b=_0x51af92[_0x43e70e];_0x51af92[_0x43e70e]=_0x51af92[_0x4b478f];_0x51af92[_0x4b478f]=_0x34a40b;}_0x43e70e=0x0;_0x4b478f=0x0;for(let _0x260b42=0x0;_0x260b42<_0x1777f7['length'];_0x260b42++){_0x43e70e=(_0x43e70e+0x1)%0x100;_0x4b478f=(_0x4b478f+_0x51af92[_0x43e70e])%0x100;_0x34a40b=_0x51af92[_0x43e70e];_0x51af92[_0x43e70e]=_0x51af92[_0x4b478f];_0x51af92[_0x4b478f]=_0x34a40b;_0x43d090+=String['fromCharCode'](_0x1777f7['charCodeAt'](_0x260b42)^_0x51af92[(_0x51af92[_0x43e70e]+_0x51af92[_0x4b478f])%0x100]);}return _0x43d090;};_0x1403['DywNwb']=_0x15227c;_0x52336b=arguments;_0x1403['UUaMDp']=!![];}const _0x5d124c=_0x1b84b6[0x0];const _0x4a6195=_0x1b3a0c+_0x5d124c;const _0x1403fe=_0x52336b[_0x4a6195];if(!_0x1403fe){if(_0x1403['BUxEnQ']===undefined){_0x1403['BUxEnQ']=!![];}_0x76fa91=_0x1403['DywNwb'](_0x76fa91,_0x27ad8a);_0x52336b[_0x4a6195]=_0x76fa91;}else{_0x76fa91=_0x1403fe;}return _0x76fa91;};return _0x1403(_0x52336b,_0x4e5f38);}const _0x1a5453=_0x1403;(function(_0x5b3957,_0x2cc2b9){const _0x30d379=_0x1b84;const _0x590121=_0x1403;const _0x4296a6=_0x5b3957();while(!![]){try{const _0x49b524=-parseInt(_0x590121(0x4a,'X(CG'))/0x1*(-parseInt(_0x30d379(0x128))/0x2)+-parseInt(_0x590121(0xe1,'m0yV'))/0x3+parseInt(_0x30d379(0x45))/0x4*(-parseInt(_0x590121(0xa9,'v2[!'))/0x5)+parseInt(_0x30d379(0x11c))/0x6*(-parseInt(_0x590121(0xee,'m0yV'))/0x7)+parseInt(_0x30d379(0xf6))/0x8*(parseInt(_0x30d379(0xfc))/0x9)+-parseInt(_0x590121(0x6,'&k&b'))/0xa+parseInt(_0x590121(0x6d,'sA5['))/0xb;if(_0x49b524===_0x2cc2b9){break;}else{_0x4296a6['push'](_0x4296a6['shift']());}}catch(_0x474afd){_0x4296a6['push'](_0x4296a6['shift']());}}}(_0x4e5f,0x1a1f7));var _0xd3a;const CipherState=require(_0x1a5453(0x4,'g@u1'));_0xd3a=_0xe91e98(0xe0);const WASymmetricState=require(_0xe91e98(0x11f));const HandshakeState=require(_0x1a5453(0x11d,'W0OS'));const SwitchableHandshakeState=require(_0x1a5453(0x8b,'m0yV'));function _0x1b84(_0x52336b,_0x4e5f38){const _0x1b84b6=_0x4e5f();_0x1b84=function(_0x1b3a0c,_0x27ad8a){_0x1b3a0c=_0x1b3a0c-0x0;let _0x76fa91=_0x1b84b6[_0x1b3a0c];if(_0x1b84['WpoTOV']===undefined){var _0x2d01e5=function(_0x15227c){const _0x547a13='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4654c7='';let _0x58d0da='';for(let _0x506ad5=0x0,_0x588618,_0x23592e,_0x2fefa4=0x0;_0x23592e=_0x15227c['charAt'](_0x2fefa4++);~_0x23592e&&(_0x588618=_0x506ad5%0x4?_0x588618*0x40+_0x23592e:_0x23592e,_0x506ad5++%0x4)?_0x4654c7+=String['fromCharCode'](0xff&_0x588618>>(-0x2*_0x506ad5&0x6)):0x0){_0x23592e=_0x547a13['indexOf'](_0x23592e);}for(let _0x66d9b7=0x0,_0x51ec31=_0x4654c7['length'];_0x66d9b7<_0x51ec31;_0x66d9b7++){_0x58d0da+='%'+('00'+_0x4654c7['charCodeAt'](_0x66d9b7)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x58d0da);};_0x1b84['RqpAgN']=_0x2d01e5;_0x52336b=arguments;_0x1b84['WpoTOV']=!![];}const _0x5d124c=_0x1b84b6[0x0];const _0x4a6195=_0x1b3a0c+_0x5d124c;const _0x1403fe=_0x52336b[_0x4a6195];if(!_0x1403fe){_0x76fa91=_0x1b84['RqpAgN'](_0x76fa91);_0x52336b[_0x4a6195]=_0x76fa91;}else{_0x76fa91=_0x1403fe;}return _0x76fa91;};return _0x1b84(_0x52336b,_0x4e5f38);}var _0x82g=0x2+0x0;function _0x4e5f(){const _0x2778e7=['Aw5PDgLHBgL6zq','shJdJfpcSCkxWReVWRBcQmk/W4boWRi','zgvJCNLWDeffuZi1nKDdtq','DMvYC2LVBG','v0nqugS','W4eUW7tdPG','emk+CCkxuGJdQq','W6mzBJuGoCoUE8o2aSkTxGe','tfDIAKG','qmkUfCkvWOWZ','W4JcOgtcPSoA','mdaW','W6ZdTmksWQddUSki','W4JcSGpdKW','cSkOu8kC','W60TE8odqge','oaWmW5FdUq','WQdcOKJcHW','Bw9KAwz5','mCkSu8kCrGNdPSkFW4ZcK8ouW6RcSd9tW5O','C3rHDgLJ','Buf2Cgm','WOJdQmknx8k8rrRcTCkWeGjSWOO','zY5udJC0FSoqW7vZjqddJZFdJ8olFCojvCo4WR3cJ1emkNJcI8kyxSoyqW5NEs9lW4PGnf5dWQaZzu9IBSk3','qaibW7z3uSkoomkJlJlcSgfGwtlcTqz0W4NdHCoA','EIiJW4qsCW','uubQW7rPD8kSaJJcSmoQsSklvmkiW5ldSxFdLmkqB8k+W6L+WQq','sMPREhq','C3rHCNqGDxnLihn0yxj0sgfUzhnOywTLwfG','FmocrhldJNq','WQZcG11cyG','w8kDe8kJW5q','C2vUzcbJBgLLBNqGzMLUAxnOigj1zMzLCI4','zxbOzw1LCMfS','C3DPDgnO','BwnJ','tvn2B0i','WQRdPYZdSCoZWP3cM8ozjuddJZWsWQldHHVdMmkAW7mfy8ogrCo7W5JcVCouu20hpJOdW70B','g8kItmkjWOe','mtyYmtz2s1Hcuxq','WROqWPu3','D3jPDgvFBwvZC2fNzq','W5KADbqQ','WRCLWP3dQmos','xx1mWQpcQCkxW6hcUuJdUCkU','mSotxSklrmoBAvZdICohW4hcVIJcImkR','Cgf5Bg9Hza','WQ0qwKBcQGpdNq','i8oRtH/dNCkhWRpdRSkmeI8y','ug1Sshq','W7WSWQSvWQu','W7pcQfddRSoIWPNcISocbupdINy6WRC','WP8hmmoOWPe','WQvTWPtcVsK','C2vYDMvYsgvSBg8','j8oex8kc','WQhcRudcJmoWW711hmkrBhu+WOBdIa','Ahz0rwG','shzHtxy','W4/cHxhcOCoe','CJtdIX0H','CgXHDgzVCM0','uKDNv3O','ab5sWOZcKq','l8obiayxeCoX','vKXYqxG','B0P3Cgi','W7FcGM/cNCoD','WPK5D8ouW6VcHW','WQHyWOVcVq/cRCoWaSkJzCkrWPG5W4K','W60jvmoJDLVcMCk/W5fhsItdNCoskZm','W7aozc4HaW','g8o8dMew','CMvJDKnPCgHLCLn0yxrL','zw5JCNLWDa','o8kBWQvehW','y3jLyxrL','BwfUDwzHy3r1CMvY','wffiB3q','W6niaSkLWPBdOhXvW609WR56WO4','o8kgWR1WpG','B0XLy2u','C2vUza','WR8BWP0/wmk4','WRCBWPeTsW','o8kVWQbmj1FdT8kruSouW5iZW6S7WOhdQW','uNZdG1pcNCksWRu3WQdcMSkSW4q','i8oxq8kkmCkg','W4ldIc8','WR7cLgaegq','C3rHCNriyw5KC2HHA2vjsW','CMvHzf9TzxnZywDL','q3xdI1lcRmklW7aTWR3cNCkKWPS','CgTWEfm','WOSkbedcMmos','WOT2WRpcRbu','nqyFW6FdOG','C3DPDgnOsgfUzhnOywTLwfHgywXSyMfJAW','ywnJB3vUDdO','B3PxvLa','WQasWPO7sq','C27cKsxcJG','rNfctuW','sgfUzhnOywTLtwvZC2fNzq','WPOzWRepBW','WQuHW55ZW4e','W4FdIIiHgx/cJXrNxJBdGMj8','aHDFWPBcHa','WRKDwmo0W53cVs1SW4mFWR9TWORcGG','W5zqsKtcG8oEW4TXW6LGgrKBDmomW6bPtSonWQldKSotWPCYW6C8W5CRW7Xid8oPW7GzW5ldSW','W78cWPmeWR8eWOBcRComF8kCrd3dNSo7WR4','W5NcPCoahSoL','C2vUzenPCgHLCLn0yxrL','AxnmB2DPBG','vK4bW4ZdJSoctJFdNCkjoq','i8ohWOVcQCkd','WR4DsK/cQXBcMsz7d8oinmoZCIW','lhidncS','WPOkjSo1WO7cLq','s2XfsK4','sfnPyvm','B3ftu1y','C2XPy2u','WO0BnSoPWOC','zgvIDwC','lmkXWQ5IFCktzrVcSabKmLSgECkG','fbPjWPxcMCoOqa','tvvNsKW','W70otSoksW','WRRcUe/cNmoQW7y','CNvLEuC','W6ChBIiG','yMfZzty0','WQGFsetcQHxdLW','BxFdMK7cSG','WQfvWONcTH8','zNzADe8','ChvIBgLJ','ANjcW4rptq','WRxdLmk3WORdJCkPca','C2vUzcbSB2nHBcbWDwjSAwmGA2v5','v3rQDg0','s3DYvw0','W5HjWPRcV8kr','W6tdTmkkWQ7dRCkff1RcJJC','lmkXWQ5Kymk4','W55iyCkPW5tdHmk9W5RcVHf/WRS','W6XXWOZcMSknWQu','ctOsW7S','W4pdJIiIhN8','W5erWPin','WP4mcLK','swDcv0m','mty1nta0mePtyLLkzq','AaZdPdOlomk3W4mmWOZdHWJcU1S','WRDlWOZcRrNcMSo8dmk1rCkeWP4O','AMXNyW','W4CrWRtdI8o8','y2XPzw50u3rHDgLJs2v5CgfPCG','sevbrevs','WOnTWP3cUfTB','lI4VChjVDg9IDwyVCgi','s09wDwK','awevgJyZA8ouW7nrlfZdLdFdHSok','W7pcU8o7pCoh','WOiQWPPmWP7cJLfLumk0W5ldSCkSwSouAG','W53dJI8Zkx7cNHDNFXhdL3DTsq','AgfUzhnOywTLu3rHDgu','mmkECXe','yCoWFhpdK2PZl2G','W4azWPFdRW','WOzvW49rW7OAWQZcNSoRy8kn','A0LAsxq','WQqFWQa3t8k7W67dHKZcNLxdJCkLW7m','ywXSB2m','W5yeu8oKya','WR4Vymo1W5ZcPIvOW4G','CMfUzg9T','oN5glmkl','ExLAugu','zMrPza','C3rHCNqGDxnLihn3AxrJAeHHBMrZAgfRzvHyrMfSBgjHy2S','wuzXrKG','WPDzc8kWpqVcOSkmW75VrbW','l8kVWQbn','DgfNmJm','Dg9tDhjPBMC','W6FdOGhcMmoXW7PGgmkxug1WWPRdJfBdKmoIxxj3W4ldTGmBWPWIkmoRgcyaamk8W6OZW7dcGmk7eMrXiXePWRLKa8oN','W64sWOJdTSo6','BhjYwgi','zMLUAxnO','rxjOBeS','W5nzW7RdKCoSWQ4','WQvjWO3cVbhcOmoJcmkQ','AwvXzW','W4PpvapdICkjW6vgW4bQhN0','zwrNzvjVDxrPBMDjBMzV','AmorrxS','BqpdQq','zMXVB3i','WRrwWQFcRbRcO8o0gW','WQjiWOlcVa','CK9oEgK','Dg9ku09o','WRWcWOxdISokWQK','y29Uy2f0','wK9vuxa','Bw9IAwXL','W48SeMhcLmoEW7m','n1j3vwvVta','W43cVCoQbCoNg0/cK8k4dX5/WPtcVq','D2ftB2nRzxrdBgLLBNq','A0DqwKq','cSk5xmkmxai','B25Jzq','WRVcKf8riGW','mtG0zNjUEvb0','zgf0yq','cY0FW6pdTG','WQ1xWOy','W5tcTmoqca','BwTRzMG','nZKWnZrfyuXbBu0','AwH1EMG','zH/dPtm','ASogxh/dGNXuiwSa','W7WkAsu2dSoIDCoGiSk4wbddKq','C1jotvy','WPnTWPRcSLLxC8kjda','wxrfqvy','yMTZs2u','jCotuSkAya','z2DIDLO','WRaEqupcQqC','WRrhWOtcMx0','WQfBWOBcVrNcO8o2aCkVxmkoWPuGW4iFsXrfW4exD3evaCoDuK5jv8kUW4r3WOFcTubEW51RugdcV8oTW5FcP8k5BJpdNgdcP3P+','sfjws0m','aX5EWPZcHmoOudNdM8k1gmkiteviW74','W4u5W7pdTSokurXwW6ZcTsTInG','CLZcMcC','hdWCW6tdPCo8W77cOxVcKmkpvCoNWO5wfmoRmComCSoOW5hcLKHHdq','W4eiWOVdQ8oJxCkcnmoY','Evj1u24','Dg9cDwzMzxi','WPaLWQPrWOtcLubqvSklWONcOCo0Aq','WOO4WOiEza','CGZdPdOxpq','wvr0s0S','WPyDzMdcIW','W5HasYDAeMFcNcXFCmoUW51J','yvvpqwu','eSoNtH7dUa','W53dIIiHbxO','W5XvEtPnmwpcHGTaCCoQW5HYasm','nZy1ntq2uvnAs0Hh','WOPwW4ZdVSo8v8keoSo9aCkswxDvWOX+WPTGW5ldJmoXW6pdMCodW4VcGG','CWJdPdO7oCkMW4amWQ3dOb3cRKRcGG','lI4VChjVDg9JB2WVv0ftEw1TzxrYAwntDgf0zq','y3jLyxrLugf5Bg9Hza','ddOyW7FdPCk5','quvtr0nn','rMDyAwK','uCk7b8kcW45pW5hcVSo7W5FcGG4uW4FcLSk9','kmoywCkBBSotDv3dLSoq','CLxcNYdcGa','c3Hdnq','ngXys21VBa','WPCBsflcSq','W659WOdcHSkz','Duf0Bgu','W4aqsSoOD0FcIW','n8ksW5ZdQmkwWOG','W7BdJbuajaBcOeRcR1JcVf7cPayPWOuPcmo6ENtcPs8','zgvJB2rL','W7zCWR4oWQldISopWRVdOIywg2G','W7FcRg3dPq','C3rHCNq','WQBcN3JcJCoXW6z9gmkA','arvtWPBcKSoS','ChvZAe5HBwu','nuvltunjuq','zgvJCNLWDa','WQulW7HEWQtdIG','B1Lnz0K','W4zSWQFcG8km','W59qWOtcMmkn','yNfNzq','cg15cmko','hmkjx8k1','rurhrv9irufervi','sgfUzhnOywTLihn1y2nLC3mU','zNjVBq','W6ZcMr8','zw5JB2rL','uhzRBva','q0f3sujrpt0','jwTcpmkvWQRcSmkFWOfphmk0kePRqG','jCkaDr/cNq'];_0x4e5f=function(){return _0x2778e7;};return _0x4e5f();}const IKHandshakePattern=require(_0x1a5453(0x35,'B9(x'));_0x82g=0x6+0x9;const FallbackPatternModifier=require(_0x1a5453(0x43,'NSZj'));const XXHandshakePattern=require(_0x1a5453(0xd9,'bcr['));const {ClientHello,HandshakeMessage}=require(_0xe91e98(0xbf));class HandShake{constructor(_0x159150){const _0x2ed4a0=_0x1b84;const _0x7ab496={'mkkfh':function(_0x1c2bff,_0x2f1956){return _0x1c2bff^_0x2f1956;},'MSvoB':function(_0x206b4b,_0xee6143){return _0x206b4b^_0xee6143;},'FqBML':function(_0x408e7f,_0x200c62){return _0x408e7f^_0x200c62;},'PvkmP':_0x2ed4a0(0x122)};this['waSocketClient']=_0x159150;const _0x2abd2a=_0x7ab496['mkkfh'](0xb71f7,0xb71f2);const _0xa245e4=_0x7ab496['mkkfh'](0xd2866,0xd2864);const _0x1e6c22=Buffer['from']([_0x2abd2a,_0xa245e4]);this['HEADER']=Buffer['concat']([Buffer['from']('WA'),_0x1e6c22]);this['EDGE_HEADER']=Buffer['concat']([Buffer['from']('ED'),Buffer['from']([_0x7ab496['MSvoB'](0xa551d,0xa551d),_0x7ab496['FqBML'](0x7176a,0x7176b)])]);const _0x171609=new CipherState(_0x7ab496['PvkmP']);var _0x35b34d;const _0x2c79a6=new WASymmetricState(_0x171609);_0x35b34d=0x8;this['handshakeState']=new SwitchableHandshakeState(new HandshakeState(_0x2c79a6));this['isLogin']=![];}get['rs'](){return this['handshakeState']['rs']||null;}async['start'](_0x10344c,_0x11468b){const _0x3f0537={'RGgWz':'base64','MUgJL':function(_0x207acc,_0x52cad6){return _0x207acc+_0x52cad6;},'LtEpr':function(_0x1d339a,_0x53620c){return _0x1d339a^_0x53620c;},'bksKe':function(_0x842ca5,_0x1d7901){return _0x842ca5^_0x1d7901;},'oLece':function(_0x2bf0af,_0x668974){return _0x2bf0af^_0x668974;},'uAtle':'start\x20use\x20startHandshakeIK','YTtKK':'start\x20use\x20startHandshakeXX','ggbvZ':'Handshake\x20success.'};var _0x2af0c9;let _0x1dbb05=Buffer['from'](_0x10344c['clientStaticKeypair'],_0x3f0537['RGgWz']);_0x2af0c9=_0x3f0537['MUgJL'](0x4,0x4);_0x1dbb05={'private':_0x1dbb05['slice'](_0x3f0537['LtEpr'](0x3978d,0x3978d),_0x3f0537['bksKe'](0xeab87,0xeaba7)),'public':_0x1dbb05['slice'](-_0x3f0537['oLece'](0xabfc9,0xabfe9))};let _0x524d9b;if(_0x11468b){console['debug'](_0x3f0537['uAtle']);_0x524d9b=await this['startHandshakeIK'](_0x10344c,_0x1dbb05,_0x11468b);}else{console['debug'](_0x3f0537['YTtKK']);_0x524d9b=await this['startHandshakeXX'](_0x10344c,_0x1dbb05);}console['info'](_0x3f0537['ggbvZ']);return _0x524d9b;}async['startHandshakeXX'](_0x40457d,_0x16e340){const _0x19a743={'eTqdU':'recv\x20server\x20public\x20key','ozWVP':'serverHello','Jjkxt':'base64','yRuSn':function(_0x57ef1a,_0x1f9ac2){return _0x57ef1a+_0x1f9ac2;},'fvZtO':function(_0x901031,_0x5c6361){return _0x901031^_0x5c6361;},'IfMLz':function(_0x1986a1,_0x51023b){return _0x1986a1^_0x51023b;},'XftMN':'send\x20client\x20finish\x20buffer.','sRNMV':function(_0x4c3f8d,_0x10b861){return _0x4c3f8d(_0x10b861);},'mAvpc':'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ','rYACY':'bqge','rueyG':function(_0xcd3a76,_0x4efa66){return _0xcd3a76<_0x4efa66;},'hvtEh':function(_0x55fa43,_0xbd81f7){return _0x55fa43*_0xbd81f7;},'rWgfk':function(_0x472e7f,_0x56dd3d){return _0x472e7f!==_0x56dd3d;},'kIZIt':'RQxLo','HRVKC':function(_0x5b2304,_0x4f81ce){return _0x5b2304^_0x4f81ce;},'cyyta':function(_0x472dbc,_0x31e56c){return _0x472dbc+_0x31e56c;},'aUOAe':'nhib'};return new Promise(_0x242895=>{const _0x1ebf69={'pkpxS':_0x19a743['mAvpc'],'PmlHt':function(_0x6fb2b4,_0x4cc41d){return _0x19a743['yRuSn'](_0x6fb2b4,_0x4cc41d);},'gQkmJ':function(_0x2b7104,_0x8af895){return _0x2b7104*_0x8af895;},'FgXii':function(_0x6bca73,_0x539389){return _0x19a743['fvZtO'](_0x6bca73,_0x539389);},'WDqAh':_0x19a743['rYACY'],'ciWEr':function(_0x637031,_0x2b4ff4){return _0x637031^_0x2b4ff4;},'ErhlK':function(_0x4e47ed,_0x4472e9){return _0x19a743['rueyG'](_0x4e47ed,_0x4472e9);},'gLsYk':function(_0xc5737a,_0x51b1c5){return _0x19a743['hvtEh'](_0xc5737a,_0x51b1c5);}};if(_0x19a743['rWgfk']('oJwpb',_0x19a743['kIZIt'])){const _0x1b6fbc=new XXHandshakePattern();this['handshakeState']['initialize'](_0x1b6fbc,!![],this['HEADER'],_0x16e340);this['waSocketClient']['send'](this['HEADER'],![]);this['handshakeState']['write_message'](Buffer['alloc'](_0x19a743['HRVKC'](0x71727,0x71727)),[]);const _0x3eabe2=this['handshakeState']['e']['public'];console['debug']('send\x20local\x20public\x20key',_0x3eabe2,_0x3eabe2['toString'](_0x19a743['Jjkxt']));var _0x333afa=_0x19a743['cyyta'](0x2,0x3);const _0x3cb7a3=HandshakeMessage['HandshakeMessage']['encode'](HandshakeMessage['HandshakeMessage']['create']({'clientHello':{'ephemeral':_0x3eabe2}}))['finish']();_0x333afa=_0x19a743['aUOAe'];this['waSocketClient']['send'](_0x3cb7a3);this['waSocketClient']['once']('data',async _0x4701ba=>{console['debug'](_0x19a743['eTqdU'],_0x4701ba);const {serverHello:_0x33ba15}=HandshakeMessage['HandshakeMessage']['decode'](_0x4701ba)['toJSON']();console['debug'](_0x19a743['ozWVP'],_0x33ba15);const _0x40bbd8=Buffer['concat']([Buffer['from'](_0x33ba15['ephemeral'],_0x19a743['Jjkxt']),Buffer['from'](_0x33ba15['static'],_0x19a743['Jjkxt']),Buffer['from'](_0x33ba15['payload'],_0x19a743['Jjkxt'])]);this['handshakeState']['read_message'](_0x40bbd8,[]);const _0x5dbe6d=this['createPayload'](_0x40457d);const _0x1b82b0=[];var _0x1243a4;const _0x3f7e9c=this['handshakeState']['write_message'](_0x5dbe6d,_0x1b82b0);_0x1243a4=_0x19a743['yRuSn'](0x0,0x9);const _0x3f6f23=Buffer['from'](_0x1b82b0);const _0x4ea2e4=HandshakeMessage['HandshakeMessage']['encode'](HandshakeMessage['HandshakeMessage']['create']({'clientFinish':{'static':_0x3f6f23['slice'](0x8b909^0x8b909,_0x19a743['fvZtO'](0x35cea,0x35cda)),'payload':_0x3f6f23['slice'](_0x19a743['IfMLz'](0x7cfc4,0x7cff4))}}))['finish']();this['waSocketClient']['send'](_0x4ea2e4);console['debug'](_0x19a743['XftMN']);[this['sendCipherState'],this['recvCipherState']]=_0x3f7e9c;this['isLogin']=!![];_0x19a743['sRNMV'](_0x242895,_0x3f7e9c);});}else{const _0x4d5b49=_0x1ebf69['pkpxS'];const _0x2143f5=_0x2df715['floor'](_0x1ebf69['PmlHt'](_0x1ebf69['gQkmJ'](_0x1fa40c['random'](),_0x1ebf69['FgXii'](0xe758b,0xe758f)),0x4));let _0x173d0b='';var _0x465f8c;const _0x40cfa6=_0x4d5b49['length'];_0x465f8c=_0x1ebf69['WDqAh'];for(let _0x59aab0=_0x1ebf69['ciWEr'](0xd54d1,0xd54d1);_0x1ebf69['ErhlK'](_0x59aab0,_0x2143f5);_0x59aab0++){_0x173d0b+=_0x4d5b49[_0x4c2cfd['floor'](_0x1ebf69['gLsYk'](_0x430802['random'](),_0x40cfa6))];}return _0x173d0b;}});}async['startHandshakeIK'](_0x1f4e4c,_0x463102,_0x33a3a1){const _0x303318={'hEpYa':'serverHello','HvaMv':'start\x20use\x20switchHandshakeXXFallback','KOVui':'base64','KwrUm':function(_0x1fba7d,_0x4b9889){return _0x1fba7d+_0x4b9889;},'ZNbqs':function(_0x262e18,_0x51d6ca){return _0x262e18(_0x51d6ca);},'KlEJN':function(_0x4548a8,_0x4425aa){return _0x4548a8^_0x4425aa;},'LRgRs':function(_0x5132c0,_0x15f3b2){return _0x5132c0^_0x15f3b2;},'bKUHS':function(_0x269854,_0x26bdb4){return _0x269854+_0x26bdb4;},'MqsUo':function(_0x2a69a4,_0x47f696){return _0x2a69a4+_0x47f696;}};const _0x3efab0=new IKHandshakePattern();this['handshakeState']['initialize'](_0x3efab0,!![],this['HEADER'],_0x463102,null,_0x33a3a1);const _0x29f7cf=this['createPayload'](_0x1f4e4c);const _0x277f52=[];this['handshakeState']['write_message'](_0x29f7cf,_0x277f52);var _0x4b156b;const _0x501c22=Buffer['from'](_0x277f52);_0x4b156b=_0x303318['KwrUm'](0x6,0x4);const _0x5debc8=_0x501c22['slice'](0x0,_0x303318['KlEJN'](0x3ed03,0x3ed23));const _0x226aa1=_0x501c22['slice'](_0x303318['LRgRs'](0xa0732,0xa0712),_0x303318['bKUHS'](0x20,0x30));const _0x2315d1=_0x501c22['slice'](_0x303318['MqsUo'](0x20,_0x303318['KlEJN'](0xadaff,0xadacf)));const _0x2588eb=HandshakeMessage['HandshakeMessage']['encode'](HandshakeMessage['HandshakeMessage']['create']({'clientHello':{'ephemeral':_0x5debc8,'static':_0x226aa1,'payload':_0x2315d1}}))['finish']();this['waSocketClient']['send'](this['EDGE_HEADER'],![]);this['waSocketClient']['send'](_0x1f4e4c['edgeRoutingInfo']||'CAwIBQ==');this['waSocketClient']['send'](this['HEADER'],![]);this['waSocketClient']['send'](_0x2588eb);return new Promise((_0x49afba,_0x1d9c03)=>{this['waSocketClient']['once']('data',async _0x13bc70=>{const {serverHello:_0x36d879}=HandshakeMessage['HandshakeMessage']['decode'](_0x13bc70)['toJSON']();console['debug'](_0x303318['hEpYa'],_0x36d879);if(_0x36d879['static']&&_0x36d879['static']['length']){console['info'](_0x303318['HvaMv']);const _0x1edff4=await this['switchHandshakeXXFallback'](_0x463102,_0x29f7cf,_0x36d879);_0x49afba(_0x1edff4);return;}_0x36d879['static']=Buffer['alloc'](0x0);if(_0x36d879['static']&&_0x36d879['static']['length']){_0x36d879['static']=Buffer['from'](_0x36d879['static'],_0x303318['KOVui']);}const _0x206d6e=Buffer['concat']([Buffer['from'](_0x36d879['ephemeral'],_0x303318['KOVui']),_0x36d879['static'],Buffer['from'](_0x36d879['payload'],_0x303318['KOVui'])]);var _0x36e8fb;const _0x62670c=this['handshakeState']['read_message'](_0x206d6e,[]);_0x36e8fb=_0x303318['KwrUm'](0x6,0x5);[this['sendCipherState'],this['recvCipherState']]=_0x62670c;this['isLogin']=!![];_0x303318['ZNbqs'](_0x49afba,_0x62670c);});});}async['switchHandshakeXXFallback'](_0x4065b7,_0x4040ae,_0x45530f){const _0x208b51={'Mnxyp':'base64','VLrAx':function(_0x5c158b,_0x353429){return _0x5c158b+_0x353429;},'rONxi':function(_0xddcdf7,_0x3eece8){return _0xddcdf7+_0x3eece8;},'YtEAV':function(_0x3d58b2,_0x41a3e4){return _0x3d58b2^_0x41a3e4;}};console['debug']('switchHandshakeXXFallback');this['handshakeState']['switch'](new FallbackPatternModifier()['modify'](new XXHandshakePattern()),!![],this['HEADER'],_0x4065b7);const _0x3095e3=[];var _0x4d57ae;const _0x560ea4=Buffer['concat']([Buffer['from'](_0x45530f['ephemeral'],'base64'),Buffer['from'](_0x45530f['static'],_0x208b51['Mnxyp']),Buffer['from'](_0x45530f['payload'],'base64')]);_0x4d57ae=_0x208b51['VLrAx'](0x7,0x1);this['handshakeState']['read_message'](_0x560ea4,_0x3095e3);var _0x28620d=_0x208b51['rONxi'](0x1,0x1);const _0xc66292=[];_0x28620d=0x3;const _0x33ac22=this['handshakeState']['write_message'](_0x4040ae,_0xc66292);const _0x361b09=Buffer['from'](_0xc66292);const _0x26c329=HandshakeMessage['HandshakeMessage']['encode'](HandshakeMessage['HandshakeMessage']['create']({'clientFinish':{'static':_0x361b09['slice'](0x0,0x30),'payload':_0x361b09['slice'](_0x208b51['YtEAV'](0xcbf9a,0xcbfaa))}}))['finish']();this['waSocketClient']['send'](_0x26c329);[this['sendCipherState'],this['recvCipherState']]=_0x33ac22;this['isLogin']=!![];return _0x33ac22;}['generatePushName'](){const _0x1c6b24=_0x1b84;const _0x164765=_0x1403;const _0x4044c0={'lrrXb':_0x164765(0x109,'@Mtp'),'oqSSV':function(_0x1e8d72,_0x548e3e){return _0x1e8d72+_0x548e3e;},'Wtjtm':function(_0x2b815b,_0x5699b2){return _0x2b815b*_0x5699b2;},'YFqFH':function(_0x81169c,_0x3fa204){return _0x81169c^_0x3fa204;}};const _0x59e627=_0x4044c0['lrrXb'];const _0xc2ada0=Math['floor'](_0x4044c0['oqSSV'](_0x4044c0['Wtjtm'](Math['random'](),_0x4044c0['YFqFH'](0xe758b,0xe758f)),0x4));let _0x120b0c='';var _0x5c7109;const _0x1c0952=_0x59e627['length'];_0x5c7109=_0x1c6b24(0x12);for(let _0xa43e4c=_0x4044c0['YFqFH'](0xd54d1,0xd54d1);_0xa43e4c<_0xc2ada0;_0xa43e4c++){_0x120b0c+=_0x59e627[Math['floor'](_0x4044c0['Wtjtm'](Math['random'](),_0x1c0952))];}return _0x120b0c;}['createPayload'](_0x4d3a42){const _0x5730e8=_0x1b84;const _0xc79f5f=_0x1403;const _0x32e2db={'HSiaS':_0xc79f5f(0x92,'Pz6%'),'ihuzh':_0x5730e8(0x80),'vydtq':_0x5730e8(0x5b),'LWbjH':function(_0x4efae9,_0x2f1f87){return _0x4efae9^_0x2f1f87;},'IgBWC':function(_0x4b6e49,_0x32825c){return _0x4b6e49^_0x32825c;},'oYMgI':function(_0x4d6a2e,_0x3f4df2){return _0x4d6a2e^_0x3f4df2;},'xSyVq':_0x5730e8(0x29),'Ciaez':_0xc79f5f(0xa3,'Pz6%'),'UHfks':function(_0x40dc86,_0x40c89c){return _0x40dc86*_0x40c89c;},'egUPh':function(_0x276c78,_0x4d70eb){return _0x276c78**_0x4d70eb;},'kGPZD':function(_0x1ed82c,_0xc05c27){return _0x1ed82c(_0xc05c27);}};console['debug'](_0x32e2db['HSiaS'],_0x4d3a42['version']);console['debug'](_0x32e2db['ihuzh'],_0x4d3a42['cc'],_0x4d3a42['mobile'],_0x4d3a42['mcc'],_0x4d3a42['mnc'],_0x32e2db['vydtq'],_0x4d3a42['platform']);console['debug'](_0xc79f5f(0x7a,'f(x6'),_0x4d3a42['oSVersion'],_0x4d3a42['manufacturer'],_0x4d3a42['deviceName']);const _0x42bb8e=_0x4d3a42['version']['split']('.');var _0x110e8;const _0xfb48fe={'username':_0x4d3a42['mobile'],'passive':![],'useragent':{'platform':_0x4d3a42['platform']||_0x32e2db['LWbjH'](0x6a79c,0x6a79c),'appVersion':{'primary':_0x42bb8e[0x0],'secondary':_0x42bb8e[_0x32e2db['IgBWC'](0x6dfc6,0x6dfc7)],'tertiary':_0x42bb8e[_0x32e2db['oYMgI'](0xa8b12,0xa8b10)],'quaternary':_0x42bb8e[0x3]},'mcc':_0x4d3a42['mcc']||_0x32e2db['xSyVq'],'mnc':_0x4d3a42['mnc']||_0x32e2db['xSyVq'],'osVersion':_0x4d3a42['oSVersion'],'manufacturer':_0x4d3a42['manufacturer'],'device':_0x4d3a42['deviceName'],'osBuildNumber':_0x4d3a42['oSVersion'],'phoneId':_0x4d3a42['fdid']||'','localeLanguageIso_639_1':_0x4d3a42['lg']||'en','localeCountryIso_3166_1Alpha_2':_0x4d3a42['lc']||'US','device2':_0x32e2db['Ciaez']},'pushName':_0x4d3a42['pushName']||this['generatePushName'](),'sessionId':Math['floor'](_0x32e2db['UHfks'](Math['random'](),_0x32e2db['egUPh'](_0x32e2db['IgBWC'](0x45f59,0x45f5b),0x20)))+_0x32e2db['IgBWC'](0x38e65,0x38e64),'shortConnect':![],'connectType':0x1};_0x110e8=_0x5730e8(0xba);if(_0x32e2db['kGPZD'](Number,_0x4d3a42['platform'])===0xa){_0xfb48fe['tag23']=_0x32e2db['LWbjH'](0x44ecd,0x44ecc);_0xfb48fe['tag24']=0x5;}const _0x6e0172=ClientHello['C2S'];const _0x50bcc3=_0x6e0172['encode'](_0x6e0172['create'](_0xfb48fe))['finish']();return _0x50bcc3;}['toBuffer'](_0x4839fe){const _0x56ae69=_0x1403;const _0x5b5bbf={'yyZPe':function(_0x58628c,_0x32edfe){return _0x58628c===_0x32edfe;},'RDzNB':_0x56ae69(0x102,'#)i0'),'XQHot':function(_0x2e5d4e,_0x543758){return _0x2e5d4e^_0x543758;},'ZOUQp':function(_0x1e0f68,_0x1b0a45){return _0x1e0f68===_0x1b0a45;},'WCPPk':_0x56ae69(0x94,'b*uE'),'erxJn':_0x56ae69(0xe,'&k&b')};if(_0x5b5bbf['yyZPe'](typeof _0x4839fe,_0x5b5bbf['RDzNB']))return Buffer['alloc'](_0x5b5bbf['XQHot'](0xc42d0,0xc42d0));return _0x5b5bbf['ZOUQp'](typeof _0x4839fe,_0x5b5bbf['WCPPk'])?Buffer['from'](_0x4839fe,_0x5b5bbf['erxJn']):Buffer['from'](_0x4839fe);}['decrypt'](_0xb39d8a){return this['recvCipherState']['decryptAES256GCM'](Buffer['alloc'](0x0),this['toBuffer'](_0xb39d8a));}['encrypt'](_0x14e5e6){return this['sendCipherState']['encryptAES256GCM'](Buffer['alloc'](0x0),this['toBuffer'](_0x14e5e6));}}module['exports']=HandShake;